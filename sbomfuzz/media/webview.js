const r=acquireVsCodeApi();let c=null,i=null;function u(e={}){c=e.onRustAnalysisDone||(()=>{}),i=e.onCargoProjectRoot||(()=>{}),onFuzzRoot=e.onFuzzRoot||(()=>{}),window.addEventListener("message",n=>{const t=n.data;switch(t.command){case"cargoProjectRoot":i&&i(t.path);break;case"rustAnalysisDone":s("Rust analysis completed successfully"),c&&c(t.results||[]);break;case"fuzzRoot":onFuzzRoot&&onFuzzRoot(t.path);break;default:console.warn("Unhandled message from extension:",t);break}}),o({command:"getCargoProjectRoot"}),o({command:"getFuzzRoot"})}function o(e){r.postMessage(e)}function s(e){o({command:"log",message:e})}let a=null;const l=document.getElementById("entry-list"),d=document.getElementById("path-display-container");function m(e){const n=e.nextElementSibling;e.classList.toggle("expanded")?n.style.display="block":n.style.display="none"}const g=document.querySelectorAll(".collapsible-header");g.forEach(e=>{s("Setting up collapsible header:",e.textContent),e.addEventListener("click",()=>{s("Collapsible header clicked:",e.textContent),m(e)})});u({onCargoProjectRoot:e=>{e?(s("ðŸ“¦ Got Cargo project root: "+e),a=e,d.innerHTML=`Cargo Project Root: ${e}`):d.innerHTML="No Cargo project found."},onFuzzRoot:e=>{const n=document.getElementById("fuzz-path-display");if(e)s("ðŸ§ª Got Fuzz root: "+e),n.innerHTML=`Fuzz Root: ${e}`;else{n.innerText="No Fuzz root found.";const t=document.createElement("button");t.textContent="Create a Root",t.addEventListener("click",()=>{o({command:"createFuzzRoot",target:a})}),n.appendChild(t)}},onRustAnalysisDone:e=>{s("Rendering function results"),l.innerHTML="";for(const n of e){const t=document.createElement("div");t.className="function-button",t.innerHTML=`
        <div style="font-weight:bold; margin-bottom:4px;">
          ${n.functionModulePath}::${n.functionName}
        </div>
        <div>
          ${n.functionLocation.filePath.replace(a,"")}
        </div>
      `,t.onclick=()=>{o({command:"openLocation",filePath:n.functionLocation.filePath,offset:n.functionLocation.offset})},l.appendChild(t)}}});document.getElementById("entry-button").addEventListener("click",()=>{o({command:"requestEntries",target:"none"})});document.getElementById("start-analyzer").addEventListener("click",()=>{o({command:"runAnalyzer",target:"none",projectPath:a})});document.getElementById("test-vis").addEventListener("click",()=>{o({command:"testVisualization"})});
